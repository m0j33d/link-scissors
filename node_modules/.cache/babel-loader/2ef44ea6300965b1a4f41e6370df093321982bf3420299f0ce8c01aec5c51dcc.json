{"ast":null,"code":"import _regeneratorRuntime from\"/Users/user/node-projects/URL-shortener/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/user/node-projects/URL-shortener/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/user/node-projects/URL-shortener/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import Navbar from'../components/Navbar';import{connect}from\"react-redux\";import{Navigate}from'react-router-dom';import QRCodeViewer from'../components/QRCodeViewer';import{useFormik}from\"formik\";import*as Yup from\"yup\";import{short,getQRcode}from'../services/shortner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ShortenUrlPage=function ShortenUrlPage(_ref){var logged_in=_ref.logged_in,user=_ref.user;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),shortenedUrl=_useState2[0],setShortenedUrl=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),generateCode=_useState4[0],setGeneratedCode=_useState4[1];var formik=useFormik({initialValues:{url:\"\",custom_alias:\"\",user_id:user===null||user===void 0?void 0:user._id},validationSchema:Yup.object({url:Yup.string().url('Invalid URL').required('URL is required'),custom_alias:Yup.string(),user_id:Yup.string().required()}),onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var res,_res$data,short_url;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return short(values);case 3:res=_context.sent;_res$data=res===null||res===void 0?void 0:res.data,short_url=_res$data.short_url;setShortenedUrl(short_url);setGeneratedCode(null);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()});if(!logged_in){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});}var values=formik.values,errors=formik.errors,submitForm=formik.submitForm,isSubmitting=formik.isSubmitting,handleChange=formik.handleChange;var handleQRcodeGenerate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _res$data2;var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getQRcode({url:shortenedUrl});case 2:res=_context2.sent;setGeneratedCode(res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.url);case 4:case\"end\":return _context2.stop();}},_callee2);}));return function handleQRcodeGenerate(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center m-48\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-4\",children:\"Shorten a long link\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"input\",{name:\"url\",type:\"text\",value:values.url,onChange:handleChange,placeholder:\"Example: https://super-long-link.com/shorten-it\",className:\"border border-gray-300 rounded-l-lg px-4 py-2 w-96 focus:outline-none focus:ring focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){submitForm();},className:\"bg-[#0087CB] text-white font-semibold px-4 py-2 rounded-r-lg hover:bg-blue-600 focus:outline-none focus:ring\",children:isSubmitting?\"loading...\":\"Shorten\"})]}),errors.url&&/*#__PURE__*/_jsx(\"span\",{className:\"error\",children:errors.url}),shortenedUrl&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 w-96 flex flex-col\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-base\",children:\"Here is scissored url:\"}),/*#__PURE__*/_jsx(\"a\",{href:shortenedUrl,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-blue-500 py-4 underline hover:cursor-pointer hover:text-blue-600\",children:shortenedUrl}),/*#__PURE__*/_jsx(\"button\",{onClick:handleQRcodeGenerate,className:\"py-2 px-4 bg-[#0087CB] text-white rounded\",children:\" Generate QR code\"})]}),generateCode&&/*#__PURE__*/_jsx(QRCodeViewer,{data:generateCode})]})]});};var mapStateToProps=function mapStateToProps(state){return{logged_in:state.logged_in,user:state.user};};export default connect(mapStateToProps)(ShortenUrlPage);","map":{"version":3,"names":["React","useState","Navbar","connect","Navigate","QRCodeViewer","useFormik","Yup","short","getQRcode","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ShortenUrlPage","_ref","logged_in","user","_useState","_useState2","_slicedToArray","shortenedUrl","setShortenedUrl","_useState3","_useState4","generateCode","setGeneratedCode","formik","initialValues","url","custom_alias","user_id","_id","validationSchema","object","string","required","onSubmit","_onSubmit","_asyncToGenerator","_regeneratorRuntime","mark","_callee","values","res","_res$data","short_url","wrap","_callee$","_context","prev","next","sent","data","t0","console","log","stop","_x","apply","arguments","to","errors","submitForm","isSubmitting","handleChange","handleQRcodeGenerate","_ref2","_callee2","_res$data2","_callee2$","_context2","children","className","name","type","value","onChange","placeholder","onClick","href","target","rel","mapStateToProps","state"],"sources":["/Users/user/node-projects/URL-shortener/src/pages/Shortener.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport Navbar from '../components/Navbar';\nimport { connect } from \"react-redux\";\nimport { Navigate } from 'react-router-dom';\nimport QRCodeViewer from '../components/QRCodeViewer';\nimport { useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport { short, getQRcode } from '../services/shortner';\n\nconst ShortenUrlPage = ({ logged_in, user }: { logged_in: boolean, user: any }) => {\n  const [shortenedUrl, setShortenedUrl] = useState(null);\n  const [generateCode, setGeneratedCode] = useState(null);\n\n\n  const formik = useFormik({\n    initialValues: {\n      url: \"\",\n      custom_alias: \"\",\n      user_id: user?._id\n    },\n    validationSchema: Yup.object({\n      url: Yup.string()\n        .url('Invalid URL')\n        .required('URL is required'),\n      custom_alias: Yup.string(),\n      user_id: Yup.string().required()\n    }),\n    onSubmit: async (values) => {\n      try {\n        const res = await short(values);\n\n        const { short_url } = res?.data;\n\n        setShortenedUrl(short_url)\n        setGeneratedCode(null)\n\n      } catch (e) {\n        console.log(e)\n      }\n    }\n  })\n\n  if (!logged_in) {\n    return <Navigate to=\"/login\" />;\n  }\n\n  const { values, errors, submitForm, isSubmitting, handleChange } = formik;\n\n  const handleQRcodeGenerate = async () => {\n    const res = await getQRcode({ url: shortenedUrl });\n\n    setGeneratedCode(res?.data?.url)\n  }\n\n\n  return (\n    <>\n      <Navbar />\n      <div className=\"flex flex-col items-center justify-center m-48\">\n        <h1 className=\"text-3xl font-bold mb-4\">Shorten a long link</h1>\n        <div className=\"flex\">\n          <input\n            name=\"url\"\n            type=\"text\"\n            value={values.url}\n            onChange={handleChange}\n            placeholder=\"Example: https://super-long-link.com/shorten-it\"\n            className=\"border border-gray-300 rounded-l-lg px-4 py-2 w-96 focus:outline-none focus:ring focus:border-blue-500\"\n          />\n          <button\n            onClick={() => {\n              submitForm();\n            }}\n            className=\"bg-[#0087CB] text-white font-semibold px-4 py-2 rounded-r-lg hover:bg-blue-600 focus:outline-none focus:ring\"\n          >\n            {isSubmitting ? \"loading...\" : \"Shorten\"}\n\n          </button>\n\n        </div>\n        {errors.url && <span className=\"error\">{errors.url}</span>}\n\n\n        {shortenedUrl && (\n          <div className=\"mt-8 w-96 flex flex-col\">\n            <p className=\"text-base\">Here is scissored url:</p>\n            <a\n              href={shortenedUrl}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-blue-500 py-4 underline hover:cursor-pointer hover:text-blue-600\"\n            >\n              {shortenedUrl}\n            </a>\n\n            <button onClick={handleQRcodeGenerate} className='py-2 px-4 bg-[#0087CB] text-white rounded'> Generate QR code</button>\n          </div>\n        )}\n\n        {generateCode && <QRCodeViewer data={generateCode} />}\n      </div>\n    </>\n  );\n};\n\nconst mapStateToProps = (state: any) => {\n  return {\n    logged_in: state.logged_in,\n    user: state.user,\n  };\n};\n\nexport default connect(mapStateToProps)(ShortenUrlPage);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}